<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-kjU+l4N0Yf4ZOJErLsIcvOU2qSb74wXpOhqTvwVx3OElZRweTnQ6d31fXEoRD1Jy" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css">
    <script src=" https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
    <a target="_blank" href="https://icons8.com/icon/98957/user"></a>
    <style>
        input
        {
            width: 220px;         
        }

        .Qform 
        {
            margin-left: 30px;
        }
        .belowLabel 
        {
            font-size: 11px;
        }
        
        #SubjectDoubt 
        {
            font-size: small;
        }
        #QueryNo 
        {
            width: 60px;
        }

        .container {
        border: 2px solid #dedede;
        background-color: #f1f1f1;
        border-radius: 5px;
        width: fit-content;
        padding: 10px;
        margin: 40px 0;
        margin-left:2rem;
        }

        .darker {
        border-color: #ccc;
        background-color: #ddd;
        }

        .container::after {
        content: "";
        clear: both;
        display: table;
        }

        .container img {
        float: left;
        max-width: 60px;
        width: 100%;
        margin-right: 20px;
        border-radius: 50%;
        }

        .container img.right {
        float: right;
        margin-left: 20px;
        margin-right:0;
        }

        .time-right {
        float: right;
        color: #aaa;
        }

        .time-left {
        float: left;
        color: #999;
        }

        label 
        {
            font-weight: bold;
        }

        .voting 
        {
            width: 100px;
            height: 200px;
        }
    </style>
</head>
<body>
    <div class="Qform">
        <label for="">Your Name</label>
        <p class="belowLabel">Please enter your name so that we will get back to you</p>
        <input type="text" id="Name">
        <br>
        <label for="">Title</label>
        <p class="belowLabel">Be Specific and imagine you're asking a question to another person</p>
        <input type="text" id="SubTitle">

        <br>
        <label for="">Ask Your Doubt</label>
        <p class="belowLabel">Include all the information someone would need to answer your question</p>
        <textarea name=""  id="comment" cols="30" rows="6"></textarea>

        <br>
        <label for="">Topic</label>
        <p class="belowLabel">Please mention the question is based under which topic</p>
        <select name="" id="SubjectDoubt">
            <option value="DSA">DSA</option>
            <option value="Javscript">Javscript</option>
            <option value="Programming">Programming</option>
            <option value="Maths">Maths</option>
            <option value="OOPS">Object Oriented Programming</option>
            <option value="Others">Others</option>
        </select>
        <br>
        <label for="">Captcha No.</label>
        <p class="belowLabel">Choose any number between 1-1000</p>
        <input type="text"  id="QueryNo" value="">
        <br>
        <br>

        <button type="button" id="Insbtn" class="btn btn-primary">Submit</button>
    </div>



    <div class="voting">

        <button class="js-vote-up-btn flex--item s-btn s-btn__unset c-pointer " data-controller="s-tooltip" data-s-tooltip-placement="right" aria-pressed="false" aria-label="Up vote" data-selected-classes="fc-theme-primary" data-unselected-classes="" aria-describedby="--stacks-s-tooltip-ol7awj6t">
            <svg aria-hidden="true" class="svg-icon iconArrowUpLg" width="20" height="20" viewBox="0 0 36 36"><path d="M2 25h32L18 9 2 25Z"></path></svg>
        </button>
        <div id="--stacks-s-tooltip-ol7awj6t" class="s-popover s-popover__tooltip pe-none wmx2" aria-hidden="true" role="tooltip"> 
            102
        </div>
        <button class="js-vote-down-btn flex--item s-btn s-btn__unset c-pointer " data-controller="s-tooltip" data-s-tooltip-placement="right" aria-pressed="false" aria-label="Down vote" data-selected-classes="fc-theme-primary" data-unselected-classes="" aria-describedby="--stacks-s-tooltip-dccm9zg9">
            <svg aria-hidden="true" class="svg-icon iconArrowDownLg" width="20" height="20" viewBox="0 0 36 36"><path d="M2 11h32L18 27 2 11Z"></path></svg>
        </button><div id="--stacks-s-tooltip-dccm9zg9" class="s-popover s-popover__tooltip pe-none" aria-hidden="true" role="tooltip"><div class="s-popover--arrow"></div></div>
    </div>
    <h2>Doubt Qurries</h2>



    <div class="container mt-3">
        <table class="table table-dark">
            <thead>
                <th>Sno</th>
                <th>Name</th>
                <th>Subject</th>
                <th>DoubtTitle</th>
                <th>Doubt</th>
                <th>QuerryNo</th>
            </thead>

            <tbody id="tbody1"></tbody>
        </table>
    </div>




    <div class="container">
    <img src="https://img.icons8.com/ios-glyphs/20/undefined/user--v1.png" class="left"/>
    <p id="quest"></p>
    <p id=""></p>
    <span class="time-right">12:03</span>
    </div>

    <!-- <div class="container darker">
    <img src="https://img.icons8.com/ios-glyphs/20/undefined/user--v1.png" class="right"/>
    <p>Hey! I'm fine. Thanks for asking!</p>
    <span class="time-left">11:01</span>
    </div> -->

    <!-- <div class="container">
    <img src="https://img.icons8.com/ios-glyphs/20/undefined/user--v1.png" class="left"/>
        <p>Sweet! So, what do you wanna do today?</p>
    <span class="time-right">11:02</span>
    </div>

    <div class="container darker">
    <img src="https://img.icons8.com/ios-glyphs/20/undefined/user--v1.png" class="right"/>
        <p>Nah, I dunno. Play soccer.. or learn more coding perhaps?</p>
    <span class="time-left">11:05</span>
    </div> -->
    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
    
        // Your web app's Firebase configuration
        const firebaseConfig = {
        apiKey: "AIzaSyCUTbGVCDA0THWUySE9--2cG2NsE-okJFs",
        authDomain: "noteshare-b02d3.firebaseapp.com",
        projectId: "noteshare-b02d3",
        storageBucket: "noteshare-b02d3.appspot.com",
        messagingSenderId: "373935912718",
        appId: "1:373935912718:web:1271f8193213444726495f",
        measurementId: "G-T9RX5BEEEB"
        };
    
        const app = initializeApp(firebaseConfig);
        // const analytics = getAnalytics(app);
        import {getDatabase, ref ,get,set, child,update,remove, onValue}
        from "https://www.gstatic.com/firebasejs/9.8.2/firebase-database.js";
    
        const db = getDatabase();


        var name = document.getElementById("Name");
        var queryNo = document.getElementById("QueryNo");
        var comment = document.getElementById("comment");
        var subject = document.getElementById("SubjectDoubt");
        var title = document.getElementById("SubTitle");

        var insBtn = document.getElementById("Insbtn");


        var stno=0;
        var tbody = document.getElementById('tbody1');

        function AddItemToTable(name,queryNo,comment,subject,title){

            let trow = document.createElement("tr");
            let td1 = document.createElement('td');
            let td2 = document.createElement('td');
            let td3 = document.createElement('td');
            let td4 = document.createElement('td');
            let td5 = document.createElement('td');
            let td6 = document.createElement('td');
            

            td1.innerHTML = ++stno;
            td2.innerHTML = name;
            td3.innerHTML = subject ;
            td6.innerHTML = title;
            td5.innerHTML = comment;
            td4.innerHTML= queryNo;
        
            

           // td6.innerText='<button><img src="https://img.icons8.com/arcade/50/undefined/experimental-edit-arcade.png"/></button>'


            trow.appendChild(td1);
            trow.appendChild(td2);
            trow.appendChild(td3);
            trow.appendChild(td4);
            trow.appendChild(td5);
            trow.appendChild(td6);

            tbody.appendChild(trow);
            
        }

        function AddAllItemsToTable(TheStudent){
            stno=0;
            tbody.innerHTML='';
            TheStudent.forEach(element => {
                AddItemToTable(element.Name,element.SubTitle,element.Comment,element.Subject,element.Querry);
            })
        }


        function GetAllDataOnce()
        {
            const dbRef= ref(db);

            get(child(dbRef,"NotesShare"))
            .then((snapshot) => {
                var student =[];

                snapshot.forEach(childSnapshot =>{
                    student.push(childSnapshot.val());
                });
                AddAllItemsToTable(student);
            })
        }

        function InsertData()
        {
            set(ref(db,"NotesShare/"+queryNo.value),{
                Name:name.value,
                SubTitle:title.value,
                Subject:subject.value,
                Comment:comment.value,
                Querry:queryNo.value,
            })
            .then(()=>{
                alert("Data stored sucessfully");
            })
            .catch((error)=>{
                alert("Unsuccesful ,error "+error);
            });
        }


       // insBtn.addEventListener('click',InsertData);

        function SelectData()
        {
            const dbref = ref(db);
            get(child(dbref,"NotesShare/"+queryNo.value)).then((snapshot)=>{
                if(snapshot.exists())
                {
                    name.value = snapshot.val().Name;
                    subject.value = snapshot.val().Subject;
                    comment.value = snapshot.val().Comment;
                }
    
                else 
                {
                    alert("no data found");
                }
            })
            .catch((error)=>{
                alert("unsucessful , error "+error);
            });
        }
    
        function UpdateData()
        {
            update(ref(db,"NotesShare/"+queryNo.value),{
                Name:name.value,
                Subject:subject.value,
                Comment:comment.value,
            })
            .then(()=>{
                alert("Data updated sucessfully");
            })
            .catch((error)=>{
                alert("Unsuccesful ,error "+error);
            });
        }
    
    
        function DeleteData()
        {
            remove(ref(db,"NotesShare/"+queryNo.value))
            .then(()=>{
                alert("Data deleted sucessfully");
            })
            .catch((error)=>{
                alert("Unsuccesful ,error "+error);
            });
        }
        insBtn.addEventListener('click',InsertData);
        // selBtn.addEventListener('click',SelectData);
        // updBtn.addEventListener('click',UpdateData);
        // delBtn.addEventListener('click',DeleteData);


        window.onload = GetAllDataOnce;

    </script>
</body>
</html>